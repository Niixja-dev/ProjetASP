@model ProjetASP.Models.Paie
@{
    ViewData["Title"] = "Détails fiche de paie";
}

<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card shadow">
            <div class="card-header bg-info text-white d-flex justify-content-between align-items-center">
                <h4 class="mb-0"><i class="bi bi-file-earmark-text me-2"></i>Bulletin de paie</h4>
                <span class="badge bg-light text-dark fs-6">@Model.Periode</span>
            </div>
            <div class="card-body">
                <div class="row mb-4">
                    <div class="col-md-6">
                        <h5>Employé</h5>
                        <p class="mb-0"><strong>@Model.Employe?.NomComplet</strong></p>
                        <p class="text-muted mb-0">@Model.Employe?.Poste</p>
                    </div>
                    <div class="col-md-6 text-end">
                        @if (Model.EstPaye)
                        {
                            <span class="badge bg-success fs-5"><i class="bi bi-check-circle me-1"></i>Payé</span>
                            <p class="text-muted mb-0 mt-2">Le @Model.DatePaiement?.ToString("dd/MM/yyyy")</p>
                        }
                        else
                        {
                            <span class="badge bg-warning text-dark fs-5"><i class="bi bi-clock me-1"></i>En attente</span>
                        }
                    </div>
                </div>
                
                <table class="table table-bordered">
                    <thead class="table-light">
                        <tr><th colspan="2">Rémunération</th><th class="text-end">Montant</th></tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="2">Salaire de base</td>
                            <td class="text-end">@Model.SalaireBase.ToString("N2") €</td>
                        </tr>
                        <tr>
                            <td colspan="2">Primes</td>
                            <td class="text-end">@Model.Primes.ToString("N2") €</td>
                        </tr>
                        <tr>
                            <td colspan="2">Heures supplémentaires</td>
                            <td class="text-end">@Model.HeuresSupplementaires.ToString("N2") €</td>
                        </tr>
                        <tr>
                            <td colspan="2">Retenues</td>
                            <td class="text-end text-danger">-@Model.Retenues.ToString("N2") €</td>
                        </tr>
                        <tr class="table-secondary">
                            <td colspan="2"><strong>Salaire brut</strong></td>
                            <td class="text-end"><strong>@Model.SalaireBrut.ToString("N2") €</strong></td>
                        </tr>
                    </tbody>
                    <thead class="table-light">
                        <tr><th colspan="2">Déductions</th><th class="text-end">Montant</th></tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="2">Cotisations sociales</td>
                            <td class="text-end text-danger">-@Model.CotisationsSociales.ToString("N2") €</td>
                        </tr>
                        <tr>
                            <td colspan="2">Impôt sur le revenu</td>
                            <td class="text-end text-danger">-@Model.ImpotRevenu.ToString("N2") €</td>
                        </tr>
                        <tr class="table-secondary">
                            <td colspan="2"><strong>Total déductions</strong></td>
                            <td class="text-end text-danger"><strong>-@Model.TotalDeductions.ToString("N2") €</strong></td>
                        </tr>
                    </tbody>
                    <tfoot class="table-success">
                        <tr>
                            <td colspan="2"><strong class="fs-5">Salaire net à payer</strong></td>
                            <td class="text-end"><strong class="fs-5">@Model.SalaireNet.ToString("N2") €</strong></td>
                        </tr>
                    </tfoot>
                </table>
                
                <div class="row mt-4">
                    <div class="col-md-6">
                        <p><strong>Jours travaillés :</strong> @Model.JoursTravailles</p>
                        <p><strong>Jours d'absence :</strong> @Model.JoursAbsence</p>
                    </div>
                    @if (!string.IsNullOrEmpty(Model.Commentaire))
                    {
                        <div class="col-md-6">
                            <p><strong>Commentaire :</strong></p>
                            <p class="text-muted">@Model.Commentaire</p>
                        </div>
                    }
                </div>
            </div>
            <div class="card-footer d-flex justify-content-between">
                <a asp-action="Index" class="btn btn-secondary"><i class="bi bi-arrow-left me-2"></i>Retour</a>
                <div>
                    <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-warning"><i class="bi bi-pencil me-2"></i>Modifier</a>
                    @if (!Model.EstPaye)
                    {
                        <form asp-action="MarkAsPaid" asp-route-id="@Model.Id" method="post" style="display:inline;">
                            <button type="submit" class="btn btn-success"><i class="bi bi-check-lg me-2"></i>Marquer comme payé</button>
                        </form>
                    }
                </div>
            </div>
        </div>
    </div>
</div>
